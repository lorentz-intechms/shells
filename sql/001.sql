SELECT CONCAT('cd /home/www/conversion-api-koa; sudo node bin/main.js NonethVideo1Command --id=',vd.id , ' --url="',


  CASE WHEN path REGEXP '^https?://' THEN path 
  
  WHEN path NOT REGEXP '^/' THEN CONCAT('https://wjm.eny7kg.com/', path)
  ELSE CONCAT('https://wjm.eny7kg.com', path) 
  
  END,

  '" --filename="', CASE
    WHEN vv.file_name REGEXP '\\.[a-zA-Z0-9]+$' THEN vv.file_name
    ELSE CONCAT(vv.file_name, '.mp4')
  END,'"', IF(MOD(vd.id, 4) = 0, ';', ';') , ' #',  v.d_id, ' ', vv.sort, ' ' ,vd.resolution)  FROM `mac_vod` AS v
LEFT JOIN `mac_vurl` AS vv ON v.d_id = vv.d_id
LEFT JOIN
(
SELECT *
FROM mac_vurl_detail d1
WHERE CAST(d1.resolution AS UNSIGNED) = (
    SELECT MAX(CAST(resolution AS UNSIGNED))
    FROM mac_vurl_detail d2
    WHERE d2.vurl_id = d1.vurl_id AND d2.type = 'DECRYPTION'
) AND d1.type = 'DECRYPTION'



) AS vd
 ON vv.id = vd.vurl_id
WHERE v.d_id IN
(

56664,
86615,
68088,
19613,
30613,
64272,
2331,
11225,
18974,
340,
5534,
73494,
19356,
74837,
3713,
13045,
9064,
122,
5812,
24634,
42834,
52431,
37413,
20509,
25906,
59903,
82797,
87725,
68415,
59584,
23324,
30377,
12556,
66739,
6932,
50199,
74827,
60388,
60464,
55229,
31514,
61862,
27512,
23261,
9958,
18805,
88411,
3365,
27196,
67666,
64383,
2079,
15974,
74417,
3090,
61046,
82901,
24805,
1870,
19910,
50093,
50655,
2515,
80532,
26089,
61498,
9709,
9709,
9788,
54968,
59170,
84577,
61182,
61229,
61354,
46611,
27306,
7261,
80938,
18529,
53522,
61043,
52430,
23061,
49974,
23055,
9392,
83815,
60155,
62162,
13105,
18494,
1207,
6402,
25294,
2508,
21611,
65697,
41942,
51471,
85486,
22900,
76067,
20614,
19616,
64317,
88767,
50343,
2395,
71869,
63723,
49025,
25026,
79773,
65801,
5035,
19078,
29928,
56306,
81651,
9753,
991,
1869,
2351,
2730,
11764,
12464,
185,
1096,
2756,
21137,
45430,
4960,
11327,
59320,
21071,
57019,
290,
77520,
68099,
84785,
26062,
17046,
23344,
87337,
24602,
10506,
50712,
61050,
22980,
62347,
4829,
24625,
21480,
21628,
42111,
52132,
62218,
9425,
24492,
1646,
21755,
26510,
17055,
5642,
5901,
74466,
7567,
3913,
22320,
76335,
40173,
2475,
60850,
85601,
22440,
19799,
25407,
50610,
60367,
59630,
75097,
22907,
56958,
9674,
20580,
6769,
59350,
22109,
14463,
24141,
6506,
45622,
79094,
55732,
22433,
22801,
330,
87404,
19118,
30666,
50218,
79401,
22673,
42114,
42631,
86606,
77684,
5579,
1549,
20403,
50398,
85591,
43367,
77858,
14692,
48651,
30272,
50221,
84202,
59703,
3918,
85508,
13673,
1488,
40033,
85170,
4,
23390,
18575,
6281,
50069,
49565,
50869,
66937,
27656,
440,
5000,
43974,
1382,
20572,
88512,
59770,
42545,
76848,
900,
15463,
50142,
16954,
18611,
20456,
19555,
74097,
60734,
12560,
86314,
86700,
23335,
63635,
50044,
7010,
65048,
89576,
3542,
85509,
8100,
76151,
13445,
87347,
38578,
38716,
30210,
49464,
70759,
7864,
20275,
68414,
88092,
4189,
27652,
14800,
48665,
73855,
21576,
16904,
12536,
52631,
10217,
44178,
31394,
62409,
23020,
337,
53508,
1592,
29630,
2231,
50679,
49987,
50991,
21970,
31777,
36261,
82305,
18129,
63111,
24942,
11013,
2958,
60955,
46101,
6785,
50419,
59492,
70894,
7046,
22112,
17530,
67771,
77843,
63820,
83619,
7826,
3320,
76427,
18625,
24510,
6310,
15958

) AND vd.path NOT REGEXP '/aac/h264/hls/'
ORDER BY vd.path ASC limit 0,1000;